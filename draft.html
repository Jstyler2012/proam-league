<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Draft • Wellman Golf Club PRO-AM 2026</title>
  <link rel="stylesheet" href="./styles.css">
</head>

<body>
  <div class="wrap">

    <!-- Title -->
    <div>
      <div class="pageTitle">Draft</div>
      <div class="pageSub">Weekly pro selection • draft board • lock rules</div>
    </div>

    <!-- Shared Header -->
    <div id="siteHeader" class="sectionRule"></div>
    <script src="./partials/header.js"></script>
    <script>loadHeader("draft");</script>

    <!-- Page Controls -->
    <div class="pillrow sectionRule">
      <button class="btn secondary" id="refreshBtn">Refresh</button>
      <a class="btn secondary" href="./rules.html#draft-rules">Draft rules</a>
    </div>

    <!-- Content -->
    <div class="card" style="margin-top:16px;">
      <div class="hd">
        <h2>This Week</h2>
        <span class="badge gray" id="weekBadge">—</span>
      </div>
      <div class="bd" style="display:flex;gap:14px;align-items:center;flex-wrap:wrap">
        <img id="logo" alt="" class="weekHeroLogo" style="width:64px;height:64px;display:none;">
        <div>
          <div id="name" style="font-weight:900;font-size:18px">—</div>
          <div id="dates" style="color:var(--muted);margin-top:4px">—</div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="hd">
        <h2>Draft Board</h2>
        <span class="badge">Next step</span>
      </div>
      <div class="bd" style="color:var(--muted);line-height:1.6;">
        This page is wired for the correct weekly tournament header.<br><br>
        Next step is implementing:
        <ul style="margin:10px 0 0; padding-left:18px;">
          <li>field list (ordered by odds)</li>
          <li>draft window rules (Mon 12pm → Wed 11:59pm ET)</li>
          <li>pick locking + “change pick if unclaimed”</li>
          <li>live picks board</li>
        </ul>
      </div>
    </div>

    <div class="footer">Tip: use the Rules page for official deadlines & tiebreakers.</div>
  </div>

<script>
const API = { currentWeek: "/.netlify/functions/public/current-week" };
const $ = (id) => document.getElementById(id);

async function getJSON(url){
  const r = await fetch(url, { headers: { "accept":"application/json" }});
  const t = await r.text();
  let j = null; try{ j = t ? JSON.parse(t) : null }catch(e){}
  if(!r.ok) throw new Error((j && (j.error||j.message)) ? (j.error||j.message) : (t || r.statusText));
  return j;
}

function fmtDateRange(startISO, endISO){
  if(!startISO || !endISO) return "—";
  const opts = { month:"short", day:"numeric", year:"numeric" };
  const s = new Date(startISO + "T00:00:00");
  const e = new Date(endISO + "T00:00:00");
  return `${s.toLocaleDateString("en-US", opts)} – ${e.toLocaleDateString("en-US", opts)}`;
}

async function boot(){
  const j = await getJSON(API.currentWeek);
  const w = j.week;
  if(!w) return;

  const label = w.label || `Week ${w.week_number || "—"}`;
  $("weekBadge").textContent = label;
  $("name").textContent = w.tournament_name || "—";
  $("dates").textContent = fmtDateRange(w.start_date, w.end_date);

  if(w.logo_url){
    $("logo").src = w.logo_url;
    $("logo").style.display = "block";
  } else {
    $("logo").style.display = "none";
  }
}

$("refreshBtn").addEventListener("click", boot);
boot();
</script>
</body>
</html>
